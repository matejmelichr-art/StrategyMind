<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>StrategyMind — Klientská sekce (demo)</title>
  <meta name="description" content="Klientská sekce StrategyMind: Market Scanner, Real-Estate Analyzer a Idea Lab. Demo s predikcemi a reporty.">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { brand: "#0A2342", mint:"#2bd4a9", ink:"#0f172a" },
          boxShadow: { sweet: "0 24px 60px -28px rgba(2,6,23,.10)" },
          borderRadius: { "2xl":"1.25rem" }
        }
      }
    }
  </script>
  <!-- Chart.js pro malé grafy -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    html{scroll-behavior:smooth}
    .card{border:1px solid #e5e7eb;background:#fff;border-radius:1.25rem;box-shadow:0 24px 60px -28px rgba(2,6,23,.10)}
    .pill{border:1px solid #e5e7eb;border-radius:999px;padding:.45rem .9rem;background:#fff}
    .btn{border-radius:.9rem;padding:.65rem 1rem;font-weight:700}
    .btn-brand{background:#0A2342;color:#fff}
    .badge{font-size:.7rem;border:1px solid #e5e7eb;border-radius:999px;padding:.25rem .6rem;background:#fff}
    .table-fixed td, .table-fixed th { word-wrap: break-word; }
  </style>
</head>

<body class="bg-slate-50 text-slate-900">
  <!-- Header -->
  <header class="sticky top-0 z-50 bg-white/80 backdrop-blur border-b">
    <div class="mx-auto max-w-7xl px-4 py-3 flex items-center gap-3">
      <a href="/" class="pill">&larr; Zpět na homepage</a>
      <div class="ml-auto flex gap-2">
        <a href="#market" class="pill">Market Scanner</a>
        <a href="#realestate" class="pill">Real-Estate</a>
        <a href="#ideas" class="pill">Idea Lab</a>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="mx-auto max-w-7xl px-4 pt-8">
    <h1 class="text-3xl md:text-4xl font-extrabold">
      Klientská sekce běží <span class="align-middle">✅</span>
    </h1>
    <p class="mt-2 text-slate-600 max-w-3xl">
      Tohle je <strong>demo verze</strong> s generovanými daty. Struktura je připravená na připojení API
      (cenové feedy, zprávy, katastry, vyhledávání). Můžeš si prokliknout moduly níže,
      filtrovat symboly, rozbalit predikce a stáhnout rychlý report.
    </p>
    <div class="mt-4 flex gap-2">
      <span class="badge">Market Scanner</span>
      <span class="badge">Real-Estate Analyzer</span>
      <span class="badge">Idea Lab &amp; Chat</span>
    </div>
  </section>

  <!-- MARKET SCANNER -->
  <section id="market" class="mx-auto max-w-7xl px-4 py-8">
    <div class="flex items-start justify-between gap-4 flex-wrap">
      <div>
        <h2 class="text-2xl font-bold">Market Scanner</h2>
        <p class="text-slate-600 max-w-2xl">
          Vyhledej a filtruj akcie, indexy a krypto. Rozklikni řádek pro <em>důvod predikce</em>,
          <em>podmínky neplatnosti</em> a mini graf. V ostré verzi sem napojíme živá data a zprávy.
        </p>
      </div>
      <div class="flex gap-2">
        <button id="dlMarketReport" class="btn btn-brand">Stáhnout report (MD)</button>
      </div>
    </div>

    <!-- Filtry -->
    <div class="mt-4 grid sm:grid-cols-3 gap-3">
      <input id="q" class="rounded-xl border px-3 py-2" placeholder="Hledat symbol / název…" />
      <select id="assetType" class="rounded-xl border px-3 py-2">
        <option value="">Všechny typy</option>
        <option value="stock">Akcie</option>
        <option value="index">Index</option>
        <option value="crypto">Krypto</option>
      </select>
      <select id="sortBy" class="rounded-xl border px-3 py-2">
        <option value="symbol">Seřadit: Symbol</option>
        <option value="change1d">Seřadit: 1D %</option>
        <option value="forecastAvg">Seřadit: 1Y avg</option>
        <option value="confidence">Seřadit: Confidence</option>
      </select>
    </div>

    <!-- Tabulka -->
    <div class="card mt-5 overflow-hidden">
      <div class="overflow-x-auto">
        <table class="min-w-full table-fixed">
          <thead class="bg-slate-100 text-sm">
            <tr>
              <th class="px-3 py-2 text-left w-28">Symbol</th>
              <th class="px-3 py-2 text-left">Název</th>
              <th class="px-3 py-2 text-right w-28">Cena</th>
              <th class="px-3 py-2 text-right w-24">1D %</th>
              <th class="px-3 py-2 text-right w-24">1W %</th>
              <th class="px-3 py-2 text-right w-40">1Y predikce (min / avg / max)</th>
              <th class="px-3 py-2 text-right w-28">Conf.</th>
              <th class="px-3 py-2 w-24"></th>
            </tr>
          </thead>
          <tbody id="marketBody" class="text-sm"></tbody>
        </table>
      </div>

      <!-- Pagination (simple) -->
      <div class="flex items-center justify-between px-4 py-3 border-t">
        <div class="text-xs text-slate-500" id="pageInfo"></div>
        <div class="flex gap-2">
          <button id="prevPage" class="pill">Předchozí</button>
          <button id="nextPage" class="pill">Další</button>
        </div>
      </div>
    </div>
  </section>

  <!-- REAL ESTATE -->
  <section id="realestate" class="mx-auto max-w-7xl px-4 py-8">
    <div class="flex items-start justify-between gap-4 flex-wrap">
      <div>
        <h2 class="text-2xl font-bold">Real-Estate Analyzer</h2>
        <p class="text-slate-600 max-w-2xl">
          Demo feed nemovitostních příležitostí s odhadovaným <strong>yields</strong>, <strong>ROI</strong>
          a krátkým AI komentářem. V ostré verzi doplníme napojení na katastr, fotky a zdroje.
        </p>
      </div>
      <button id="dlRealReport" class="btn btn-brand">Stáhnout report (MD)</button>
    </div>

    <div id="realList" class="mt-4 grid md:grid-cols-2 gap-4"></div>
  </section>

  <!-- IDEA LAB + CHAT -->
  <section id="ideas" class="mx-auto max-w-7xl px-4 py-8">
    <h2 class="text-2xl font-bold">Idea Lab &amp; Chat analytik</h2>
    <p class="text-slate-600 max-w-3xl">
      Stručný nástřel pro generování investičních/produktových nápadů. Chat je tu jako „výplň“ —
      v plné verzi napojíme tvůj model/API.
    </p>

    <div class="mt-4 grid md:grid-cols-2 gap-4">
      <div class="card p-5">
        <div class="font-semibold">Nápad: „AI market newsletter pro SMB“</div>
        <ul class="mt-2 text-sm text-slate-700 space-y-1">
          <li>• MVP: scraper + shrnutí + email</li>
          <li>• Akvizice: Twitter, LinkedIn, partnerské skupiny</li>
          <li>• Monetizace: freemium, PRO 9 €/m</li>
          <li>• KPI: open rate, CTR, CAC, LTV</li>
        </ul>
      </div>
      <div class="card p-5">
        <div class="font-semibold mb-2">Chat analytik (demo)</div>
        <textarea class="w-full border rounded-xl p-3 h-28" placeholder="Napiš dotaz (demo, neodesílá se)…"></textarea>
        <div class="mt-2 text-xs text-slate-500">V ostré verzi přidáme napojení na API a kontext z tabulek.</div>
      </div>
    </div>
  </section>

  <footer class="border-t bg-white">
    <div class="mx-auto max-w-7xl px-4 py-8 text-sm text-slate-600 flex items-center justify-between">
      <span>© 2025 StrategyMind</span>
      <a class="pill" href="/">Zpět na homepage</a>
    </div>
  </footer>

  <!-- SCRIPT: demo data + logika -->
  <script>
    // -------- DEMO DATA (připraveno na pozdější API) --------
    const MARKET_DATA = [
      {symbol:'AAPL', name:'Apple Inc.', type:'stock', price:219.85, change1d:+1.26, change1w:+2.1,
       forecast:{min:165, avg:245, max:310}, confidence:0.72,
       thesis:'Růst služeb a ekosystému, stabilní marže. Re-rating po nové produktové linii.',
       invalidate:'Breakdown pod 195 s objemy a slabý guidance.'},
      {symbol:'NVDA', name:'NVIDIA Corp.', type:'stock', price:108.20, change1d:-0.82, change1w:+4.3,
       forecast:{min:80, avg:150, max:390}, confidence:0.68,
       thesis:'Dominance v AI akceleraci, dlouhé backlogy, rozšiřování datacenter.',
       invalidate:'Prudký pokles capex u hyperscalerů, regulační zásah.'},
      {symbol:'SPY', name:'S&P 500 ETF', type:'index', price:520.10, change1d:+0.41, change1w:+1.0,
       forecast:{min:470, avg:585, max:640}, confidence:0.61,
       thesis:'Široký růst, měkké přistání, sazby postupně níž.',
       invalidate:'Tvrdé přistání/earnings recession, skokový růst výnosů.'},
      {symbol:'BTCUSD', name:'Bitcoin', type:'crypto', price:67200, change1d:+2.3, change1w:+6.8,
       forecast:{min:42000, avg:88000, max:120000}, confidence:0.58,
       thesis:'Poptávka přes ETF, halving + omezená nabídka, sílící narativ digitálního zlata.',
       invalidate:'Regulační tlak, silný risk-off, útok na síť.'},
      {symbol:'ETHUSD', name:'Ethereum', type:'crypto', price:3200, change1d:+1.1, change1w:+3.5,
       forecast:{min:2100, avg:4300, max:6000}, confidence:0.55,
       thesis:'L2 ekosystém, tokenizace aktiv, potenciál pro poptávku přes fondy.',
       invalidate:'Zpoždění adoption, bezpečnostní incidenty velkého rozsahu.'},
      {symbol:'TSLA', name:'Tesla Inc.', type:'stock', price:240.50, change1d:+0.9, change1w:-2.1,
       forecast:{min:170, avg:280, max:380}, confidence:0.52,
       thesis:'Software/energy story, FSD monetizace, marže po per-unit poklesu cen.',
       invalidate:'Poptávkový šok, legislativa, zpoždění FSD/robotaxi.'},
    ];

    const REAL_ESTATE = [
      {id:1, city:'Praha', country:'CZ', type:'Byt 2+kk', yield:7.2, roi5y:34, idea:'Krátkodobé ubytování / mid-term expati', src:'Katastr — odkaz', photo:''},
      {id:2, city:'Lisabon', country:'PT', type:'Retail 120 m²', yield:10.8, roi5y:52, idea:'Kavárna + služby, turistická trasa', src:'Municipální registr — odkaz', photo:''},
      {id:3, city:'Warszawa', country:'PL', type:'Pozemek 1 200 m²', yield:11.9, roi5y:60, idea:'Self-storage / parking (automat)', src:'Geoportál — odkaz', photo:''},
      {id:4, city:'Austin', country:'US', type:'Light industrial', yield:9.4, roi5y:41, idea:'E-commerce sklady last-mile', src:'County records — odkaz', photo:''},
    ];

    // -------- Pomocné --------
    const fmt = (n, d=2) => {
      if (Math.abs(n) >= 1000 && Number.isInteger(n)) return n.toLocaleString('cs-CZ');
      return Number(n).toLocaleString('cs-CZ', {maximumFractionDigits:d});
    };
    const pct = (n) => (n>=0 ? `+${n.toFixed(2)}%` : `${n.toFixed(2)}%`);

    // -------- Market Scanner render --------
    let page = 1, perPage = 6, filter = {q:'', type:'', sort:'symbol'};

    function applyFilters() {
      let rows = MARKET_DATA.filter(r=>{
        const hitQ = !filter.q || (r.symbol.toLowerCase().includes(filter.q) || r.name.toLowerCase().includes(filter.q));
        const hitT = !filter.type || r.type===filter.type;
        return hitQ && hitT;
      });
      rows.sort((a,b)=>{
        switch(filter.sort){
          case 'change1d': return b.change1d - a.change1d;
          case 'forecastAvg': return b.forecast.avg - a.forecast.avg;
          case 'confidence': return b.confidence - a.confidence;
          default: return a.symbol.localeCompare(b.symbol);
        }
      });
      return rows;
    }

    function renderTable(){
      const rows = applyFilters();
      const total = rows.length;
      const start = (page-1)*perPage, end = Math.min(start+perPage, total);
      const slice = rows.slice(start, end);

      const tbody = document.getElementById('marketBody');
      tbody.innerHTML = '';

      slice.forEach((r,i)=>{
        const tr = document.createElement('tr');
        tr.className = "border-t";
        tr.innerHTML = `
          <td class="px-3 py-2 font-semibold">${r.symbol}</td>
          <td class="px-3 py-2">${r.name}</td>
          <td class="px-3 py-2 text-right">${fmt(r.price)}</td>
          <td class="px-3 py-2 text-right ${r.change1d>=0?'text-emerald-600':'text-rose-600'}">${pct(r.change1d)}</td>
          <td class="px-3 py-2 text-right ${r.change1w>=0?'text-emerald-600':'text-rose-600'}">${pct(r.change1w)}</td>
          <td class="px-3 py-2 text-right">
            <span class="text-slate-500">${fmt(r.forecast.min,0)}</span>
            &nbsp;/&nbsp;<span class="font-semibold">${fmt(r.forecast.avg,0)}</span>
            &nbsp;/&nbsp;<span class="text-slate-500">${fmt(r.forecast.max,0)}</span>
          </td>
          <td class="px-3 py-2 text-right">${Math.round(r.confidence*100)}%</td>
          <td class="px-3 py-2 text-right">
            <button class="pill" data-idx="${i}" data-sym="${r.symbol}">Detail</button>
          </td>
        `;
        tbody.appendChild(tr);

        // detail row
        const dr = document.createElement('tr');
        dr.className = 'border-t bg-slate-50/40';
        dr.innerHTML = `
          <td colspan="8" class="px-3 py-3 hidden">
            <div class="grid lg:grid-cols-[1fr_320px] gap-4 items-start">
              <div>
                <div class="text-sm"><span class="badge">Teze</span> ${r.thesis}</div>
                <div class="text-sm mt-2"><span class="badge">Neplatí pokud</span> ${r.invalidate}</div>
              </div>
              <div class="card p-3">
                <canvas id="chart_${r.symbol}" height="120"></canvas>
                <div class="text-xs text-slate-500 mt-2">*Demo sparkline z náhodných dat.</div>
              </div>
            </div>
          </td>
        `;
        tbody.appendChild(dr);

        // toggle
        tr.querySelector('button').addEventListener('click', ()=>{
          const cell = dr.querySelector('td');
          cell.classList.toggle('hidden');
          if (!cell.dataset.chartInit) {
            cell.dataset.chartInit = '1';
            renderSparkline(`chart_${r.symbol}`);
          }
        });
      });

      document.getElementById('pageInfo').textContent = `Zobrazeno ${start+1}–${end} z ${total}`;
      document.getElementById('prevPage').disabled = page===1;
      document.getElementById('nextPage').disabled = end>=total;
    }

    function renderSparkline(id){
      const ctx = document.getElementById(id);
      if(!ctx) return;
      const data = Array.from({length:24},()=>Math.random()*10).reduce((acc,v,i)=>{
        acc.push((acc[i-1]||100) + (Math.random()-0.4)*4);
        return acc;
      },[]);
      new Chart(ctx, {
        type: 'line',
        data: { labels: data.map((_,i)=>i+1), datasets: [{ data, tension:.35, pointRadius:0 }] },
        options: { responsive:true, plugins:{legend:{display:false}}, scales:{x:{display:false},y:{display:false}} }
      });
    }

    // Listeners
    document.getElementById('q').addEventListener('input', e=>{ filter.q = e.target.value.toLowerCase(); page=1; renderTable(); });
    document.getElementById('assetType').addEventListener('change', e=>{ filter.type = e.target.value; page=1; renderTable(); });
    document.getElementById('sortBy').addEventListener('change', e=>{ filter.sort = e.target.value; page=1; renderTable(); });
    document.getElementById('prevPage').addEventListener('click', ()=>{ page = Math.max(1, page-1); renderTable(); });
    document.getElementById('nextPage').addEventListener('click', ()=>{ page = page+1; renderTable(); });

    // Reporty (Markdown download)
    function download(filename, text){
      const a = document.createElement('a');
      a.href = URL.createObjectURL(new Blob([text], {type:'text/markdown'}));
      a.download = filename;
      a.click();
      URL.revokeObjectURL(a.href);
    }
    document.getElementById('dlMarketReport').addEventListener('click', ()=>{
      const rows = applyFilters();
      const md = [
        '# StrategyMind — Market Scanner (demo)\n',
        `Počet položek: ${rows.length}\n`,
        '| Symbol | Cena | 1D% | 1W% | 1Y min/avg/max | Conf. |\n',
        '|---|---:|---:|---:|---:|---:|\n',
        ...rows.map(r=>`| ${r.symbol} | ${fmt(r.price)} | ${pct(r.change1d)} | ${pct(r.change1w)} | ${fmt(r.forecast.min,0)} / ${fmt(r.forecast.avg,0)} / ${fmt(r.forecast.max,0)} | ${Math.round(r.confidence*100)}% |`)
      ].join('\n');
      download('market_report.md', md);
    });

    // -------- Real-Estate render --------
    const realBox = document.getElementById('realList');
    function renderReal(){
      realBox.innerHTML = '';
      REAL_ESTATE.forEach(item=>{
        const el = document.createElement('div');
        el.className = 'card p-5';
        el.innerHTML = `
          <div class="flex items-start justify-between gap-3">
            <div>
              <div class="text-sm text-slate-500">${item.city}, ${item.country} — ${item.type}</div>
              <div class="mt-1 text-lg font-semibold">Yield ${item.yield}% • ROI 5Y ${item.roi5y}%</div>
              <div class="mt-1 text-sm text-slate-700">${item.idea}</div>
            </div>
            <button class="pill">Detail</button>
          </div>
          <div class="mt-3 hidden">
            <div class="grid sm:grid-cols-2 gap-3">
              <div class="aspect-video rounded-xl bg-slate-100 flex items-center justify-center text-slate-400">Foto (placeholder)</div>
              <div class="text-sm">
                <div><span class="badge">Zdroj</span> ${item.src}</div>
                <div class="mt-2"><span class="badge">Poznámka AI</span> Odhad založen na srovnatelných pronájmech a CAP rate v lokalitě.</div>
              </div>
            </div>
          </div>
        `;
        const btn = el.querySelector('button');
        const det = el.querySelector('div.mt-3');
        btn.addEventListener('click', ()=>det.classList.toggle('hidden'));
        realBox.appendChild(el);
      });
    }
    document.getElementById('dlRealReport').addEventListener('click', ()=>{
      const md = [
        '# StrategyMind — Real-Estate Analyzer (demo)\n',
        ...REAL_ESTATE.map(r=>`- **${r.city}, ${r.country}** — ${r.type}: Yield **${r.yield}%**, ROI 5Y **${r.roi5y}%**. Idea: ${r.idea} (Zdroj: ${r.src})`)
      ].join('\n');
      download('real_estate_report.md', md);
    });

    // Init
    renderTable();
    renderReal();
  </script>
</body>
</html>
