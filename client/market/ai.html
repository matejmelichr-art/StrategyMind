<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>StrategyMind ‚Äî Jarvis AI</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  <script>
    tailwind.config = { theme:{ extend:{ colors:{ brand:{500:"#06B6D4",600:"#0891B2",700:"#0E7490"}}}}};
  </script>
  <style>
    html,body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
    .pill{padding:.35rem .6rem;border:1px solid #e2e8f0;border-radius:9999px}
    .msg-user{background:#ecfeff;border-color:#a5f3fc}
    .msg-ai{background:#fff;border-color:#e2e8f0}
  </style>
</head>
<body class="bg-slate-50 text-slate-900">
  <header class="sticky top-0 z-20 bg-white/80 backdrop-blur border-b border-slate-200">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
      <a href="/client/market/" class="text-slate-600 hover:text-slate-900 flex items-center gap-2">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M15 6l-6 6 6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        Zpƒõt na Market Console
      </a>
      <span class="px-2 py-1 text-xs border border-slate-200 rounded-full">Jarvis AI ‚Ä¢ beta</span>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-4 py-6 space-y-5">
    <div class="rounded-2xl border border-slate-200 bg-white p-5">
      <h1 class="text-2xl font-semibold mb-2">ü§ñ Jarvis ‚Äî osobn√≠ AI analytik</h1>
      <p class="text-slate-600 text-sm">
        Ptej se, nahr√°vej grafy nebo sn√≠mky. Jarvis analyzuje data z trhu, zpr√°v i sentimentu a vytvo≈ô√≠ detailn√≠ predikci s √∫rovnƒõmi a d≈Øvody.
      </p>
    </div>

    <!-- Screenshot upload -->
    <div id="uploadArea" class="rounded-2xl border-2 border-dashed border-slate-300 bg-slate-50 hover:bg-slate-100 transition p-5 text-center">
      <p class="text-sm text-slate-600">üì∑ P≈ôet√°hni sem obr√°zek grafu nebo klikni pro v√Ωbƒõr souboru</p>
      <input id="fileInput" type="file" accept="image/*" class="hidden">
      <button id="pickFile" class="mt-3 pill bg-white hover:bg-slate-50 text-sm">Vybrat soubor</button>
      <div id="preview" class="hidden mt-3"><img id="shot" class="max-h-80 mx-auto rounded-xl border border-slate-200" /></div>
    </div>

    <!-- Chat -->
    <section class="rounded-2xl border border-slate-200 bg-white p-5">
      <div id="chat" class="space-y-3 max-h-[60vh] overflow-y-auto"></div>
      <div class="mt-4 flex items-end gap-2">
        <textarea id="input" rows="2" class="flex-1 rounded-lg border border-slate-300 px-3 py-2 text-sm" placeholder="Zeptej se (nap≈ô. 'Zhodno≈• support u 18500...')"></textarea>
        <button id="send" class="pill bg-brand-600 text-white hover:bg-brand-700">Odeslat</button>
      </div>
    </section>
  </main>

  <script>
    const chatEl = document.getElementById('chat');
    const input = document.getElementById('input');
    const send = document.getElementById('send');
    const pick = document.getElementById('pickFile');
    const fileInput = document.getElementById('fileInput');
    const preview = document.getElementById('preview');
    const shot = document.getElementById('shot');
    let imageData = null;

    function msg(role, text, img){
      const wrap = document.createElement('div');
      wrap.className = 'border rounded-2xl px-3 py-2 text-sm ' + (role==='user'?'msg-user':'msg-ai');
      wrap.innerHTML = text.replace(/\n/g,'<br>');
      if(img){ const im=document.createElement('img'); im.src=img; im.className='mt-2 max-h-60 rounded-xl border border-slate-200'; wrap.appendChild(im); }
      chatEl.appendChild(wrap);
      chatEl.scrollTop = chatEl.scrollHeight;
    }

    async function aiRespond(prompt){
      // --- zde by se volal server s OpenAI 4o Vision ---
      // simulace odpovƒõdi
      await new Promise(r=>setTimeout(r,1000));
      const res = `Anal√Ωza: trend ${Math.random()>0.5?'r≈Østov√Ω':'slab≈°√≠'}.\nPredikce: optimisticky +8‚Äì12%, z√°klad +4%, defenzivnƒõ -3%.\nD≈Øvody: sentiment, makro, patterny.\nDoporuƒçen√≠: ${Math.random()>0.5?'ƒçekat retrace':'mo≈æn√Ω vstup p≈ôi pullbacku'}.`;
      msg('ai', res);
    }

    send.onclick = async ()=>{
      const text = input.value.trim();
      if(!text && !imageData) return;
      msg('user', text||'(obr√°zek)', imageData);
      input.value='';
      await aiRespond(text);
      imageData=null; preview.classList.add('hidden');
    };

    pick.onclick = ()=>fileInput.click();
    fileInput.onchange = async e=>{
      const f = e.target.files[0]; if(!f) return;
      const reader = new FileReader();
      reader.onload=()=>{ imageData=reader.result; shot.src=imageData; preview.classList.remove('hidden'); };
      reader.readAsDataURL(f);
    };
  </script>
</body>
</html>
